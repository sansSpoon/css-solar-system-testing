	<!doctype html>
	<html>
	<head>
	<meta charset="UTF-8">
	<title>#</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="js/d3.min.js"></script>
	<script src="js/d3-selection-multi.min.js"></script>
	<style type="text/css">
		.h {
			border: 1px solid black;
			background-color: grey;
			width: 100%;
			height: 100px;
			position: relative;
			display: flex;
		}
		.o {
			display: flex;
			justify-content: flex-start;
			border: 1px solid blue;
			background-color: cyan;
			width: 50px;
			height: 50px;
			position: relative;
		}
		
	</style>
	
	</head>
	
	<body>
		<button id="update">update</button>
		<input id="increment" type="number" value="1" step="0.1" max="2" />
		<div id="anchor"></div>
		<script>
	
			const updateButton = document.getElementById('update');
			const increment = document.getElementById('increment');
			const anchor = d3.select('#anchor');
			const data =  [{
											"h":[
												{ 
													"p": [{"r": 4}, {"r": 7}, {"r": 10}, {"r": 15}, {"r": 52}, {"r": 96}, {"r": 192}, {"r": 301}]}
											]
										}];
										
			//console.log(...data[0].h[0].p)
			//console.log(Math.max.apply(Math,data[0].h[0].p.map(function(o) {return o.r;})))
			
			//console.log(Math.max(...data[0].h[0].p.map((o) => o.r)))

			//const data2 = [[38, 75, 113, 151, 188, 226, 263, 301]];
			
			const max = Math.max(...data[0].h[0].p.map((o) => o.r));
			console.log(max);
			
			const length = data[0].h[0].p.length;
				console.log(length);
				
			// Scale
			let xScale = d3.scaleLinear()
				.domain([0, max]).range([0, 100]);
			
			function lerp(n, x0, x1) {
				// returns a position: x that is n percent between y0 and y1
				// As orbits are x only, y values are fixed to 0(start) - 1(end)
				const y0 = 1;
				const y1 = 2;
				const x = ((y1 - n)*x0 + (n - y0)*x1) / (y1 - y0);
				
				return x;
			}

			function interp(d, i, nodes) {
				const unit = '%';
				const lerped = xScale(lerp(increment.value, d.r, max/length));
				console.log(lerped);
				return {
					'width': `${lerped}${unit}`,
				};
				
			}
			
			updateButton.addEventListener('click', function() {
				update(data);
			});
			
			increment.addEventListener('change', function() {
				update(data);
			});
			
			
			function update(data) {
				//console.clear();
				//console.log(data);
				let s = anchor.selectAll('.s').data(data);
				s.exit().remove();
				s = s.enter()
						 .append('div').attr('class', 's')
						 .merge(s);
				
				let h = s.selectAll('.h').data(function(d) { return d.h });
				h.exit().remove();
				h = h.enter()
						 .append('div').attr('class','h')
						 .merge(h);
						 
				//console.log(h);

				let p = h.selectAll('.o').data(function(d) { return d.p; });
				
				//console.log(p)
				

				p
					.transition()
					.duration(1000)
					.styles(interp);
					

				p.exit().remove();

				p = p.enter()
						.append('div')
						.attr("class", "o")
						
						.style('width', function(d) {
							//console.log(d);
							return ((10*d.r)*increment.value)+'px';
						})
						//.merge(inner)
						
						//.text(function(d) { return d; });

			}
	
		</script>
	</body>
	</html>


<!--
var text = g
  .selectAll("text")
  .data(data, key); // JOIN
text.exit() // EXIT
    .remove();
text.enter() // ENTER
  .append("text")
    .text(function(d) { return d; })
  .merge(text) // ENTER + UPDATE
    .attr("x", function(d, i) { return i * 32; });
    -->