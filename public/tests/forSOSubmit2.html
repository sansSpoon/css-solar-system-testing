	<!doctype html>
	<html>
	<head>
	<meta charset="UTF-8">
	<title>#</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://d3js.org/d3.v5.min.js"></script>
	<script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
	<style type="text/css">
		.outer {
			border: 1px solid black;
			background-color: grey;
			width: 100%;
			height: 100px;
			position: relative;
			display: flex;
		}
		.inner {
			display: flex;
			justify-content: flex-start;
			border: 1px solid blue;
			background-color: cyan;
			width: 50px;
			height: 50px;
			position: relative;
		}
		
	</style>
	
	</head>
	
	<body>
		<input id="increment" type="number" value="1" step="0.1" max="2" />
		<div id="anchor"></div>
		<script>
			const increment = document.getElementById('increment');
			const anchor = d3.select('#anchor');
			const data =  [
											{
												"outer": [
													{
														"inner": [
															{ "r": 40 },
															{ "r": 70 },
															{ "r": 10 },
															{ "r": 15 },
															{ "r": 52 },
															{ "r": 96 },
															{ "r": 192 },
															{ "r": 301 }
														]
													}
												]
											}
										];
			
			const max = Math.max(...data[0].outer[0].inner.map((o) => o.r));
			console.log(max);

			const length = data[0].outer[0].inner.length;
			console.log(length);

			let xScale = d3.scaleLinear()
				.domain([0, max]).range([0, 100]);
			
			function lerp(n, x0, x1) {
				const y0 = 1;
				const y1 = 2;
				const x = ((y1 - n)*x0 + (n - y0)*x1) / (y1 - y0);
				return x;
			}

			function interp(d, i, nodes) {
				console.log('interping');
				const unit = '%';
				const lerped = xScale(lerp(increment.value, d.r, max/length));
				return {
					'width': `${lerped}${unit}`,
				};
			}

			increment.addEventListener('change', function() {
				update(data);
			});
			
			
			function update(data) {

				// main data
				let s = anchor.selectAll('.s').data(data);
				s.exit().remove();
				s = s.enter()
						 .append('div')
						 .attr('class', 's')
						.merge(s)
				
				// outer array
				let outer = s.selectAll('.outer').data(function(d) { return d.outer });
				outer.exit().remove();
				outer = outer.enter()
									.append('div')
				.attr('class','outer')
				.merge(outer);

				// inner array
				let inner = outer.selectAll('.inner').data(function(d) { return d.inner; });

				inner
					.transition()
					.duration(1000)
					.styles(interp); //this is *NOT* being called when user updates 'increment'

				inner.exit().remove();

				inner = inner.enter()
						.append('div')
						.attr("class", "inner")
						.style('width', function(d) { return xScale(d.r*increment.value)+'%'; });
			}
			
			//run once
			update(data);
	
		</script>
	</body>
	</html>